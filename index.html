<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jamie Bothwell Blast</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    header {
      width: 100%;
      padding: 20px;
      text-align: center;
      background: rgba(0, 0, 0, 0.7);
      border-bottom: 2px solid #ff5722;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }
    
    h1 {
      font-size: 2.8rem;
      margin-bottom: 10px;
      background: linear-gradient(to right, #ff5722, #ff9800);
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      letter-spacing: 1px;
    }
    
    .tagline {
      font-size: 1.2rem;
      color: #ff9800;
      font-style: italic;
    }
    
    #canvas-container {
      position: relative;
      width: 100%;
      max-width: 1024px;
      margin: 20px auto;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
    }
    
    canvas {
      display: block;
      width: 100%;
      height: auto;
      background: #000;
    }
    
    #game-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10;
      transition: opacity 0.5s ease;
    }
    
    #game-controls {
      display: flex;
      gap: 20px;
      margin: 25px 0;
    }
    
    .control-btn {
      padding: 15px 30px;
      font-size: 1.1rem;
      font-weight: bold;
      background: linear-gradient(to bottom, #ff5722, #e64a19);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      min-width: 180px;
    }
    
    .control-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
      background: linear-gradient(to bottom, #ff7043, #f4511e);
    }
    
    .control-btn:active {
      transform: translateY(1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    #play-button {
      background: linear-gradient(to bottom, #4CAF50, #2E7D32);
    }
    
    #play-button:hover {
      background: linear-gradient(to bottom, #66BB6A, #388E3C);
    }
    
    #status-text {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #ff9800;
      text-align: center;
    }
    
    progress {
      width: 80%;
      max-width: 400px;
      height: 25px;
      border-radius: 12px;
      overflow: hidden;
      margin: 15px 0;
      border: 1px solid #333;
    }
    
    progress::-webkit-progress-bar {
      background-color: #222;
      border-radius: 12px;
    }
    
    progress::-webkit-progress-value {
      background: linear-gradient(to right, #ff5722, #ff9800);
      border-radius: 12px;
    }
    
    #description-section {
      max-width: 800px;
      margin: 30px auto;
      padding: 30px;
      background: rgba(30, 30, 46, 0.8);
      border-radius: 15px;
      border: 1px solid #444;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
      line-height: 1.6;
    }
    
    #description-section h2 {
      font-size: 2rem;
      color: #ff9800;
      margin-bottom: 20px;
      text-align: center;
      border-bottom: 2px solid #ff5722;
      padding-bottom: 10px;
    }
    
    #description-section p {
      font-size: 1.1rem;
      margin-bottom: 15px;
      color: #e0e0e0;
    }
    
    .features {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin: 25px 0;
      justify-content: center;
    }
    
    .feature-card {
      background: rgba(26, 35, 56, 0.7);
      border-radius: 10px;
      padding: 20px;
      width: 220px;
      text-align: center;
      border: 1px solid #444;
      transition: transform 0.3s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
      border-color: #ff9800;
    }
    
    .feature-card h3 {
      color: #ff5722;
      margin-bottom: 10px;
    }
    
    .instructions {
      background: rgba(26, 35, 56, 0.7);
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      border-left: 4px solid #4CAF50;
    }
    
    .instructions h3 {
      color: #4CAF50;
      margin-bottom: 10px;
    }
    
    .instructions ul {
      padding-left: 20px;
    }
    
    .instructions li {
      margin-bottom: 8px;
    }
    
    footer {
      width: 100%;
      padding: 20px;
      text-align: center;
      background: rgba(0, 0, 0, 0.7);
      margin-top: 40px;
      border-top: 1px solid #444;
    }
    
    @media (max-width: 768px) {
      h1 {
        font-size: 2.2rem;
      }
      
      #game-controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .control-btn {
        width: 100%;
      }
      
      #description-section {
        padding: 20px;
        margin: 20px 15px;
      }
    }
  </style>

  <script>
    config = {
      xtermjs: "1",
      _sdl2: "canvas",
      user_canvas: 1, // Changed to 1 for custom canvas handling
      user_canvas_managed: 1, // Enable custom canvas management
      ume_block: 0,
      can_close: 0,
      archive: "jamiebothwellblast",
      gui_debug: 3,
      cdn: "https://pygame-web.github.io/archives/0.9/",
      autorun: 0,
      PYBUILD: "3.12"
    };
  </script>
</head>

<body>
  <header>
    <h1>JAMIE BOTHWELL BLAST</h1>
    <p class="tagline">An explosive retro shooter experience!</p>
  </header>

  <div id="canvas-container">
    <canvas id="canvas" width="1024" height="600" oncontextmenu="event.preventDefault()" tabindex="1"></canvas>
    
    <div id="game-overlay">
      <div id="status-text">Preparing game environment...</div>
      <progress id="progress" value="0" max="100"></progress>
      <div id="game-controls">
        <button id="play-button" class="control-btn" disabled>LOADING...</button>
        <button id="fullscreen-button" class="control-btn">FULLSCREEN</button>
      </div>
    </div>
  </div>

  <div id="description-section">
    <h2>ABOUT THE GAME</h2>
    <p>Jamie Bothwell Blast is an action-packed retro shooter that combines classic arcade gameplay with modern visuals. Blast your way through waves of enemies, collect power-ups, and defeat challenging bosses!</p>
    
    <div class="features">
      <div class="feature-card">
        <h3>Explosive Action</h3>
        <p>Fast-paced gameplay with intense shootouts</p>
      </div>
      <div class="feature-card">
        <h3>Retro Feel</h3>
        <p>Classic arcade style with modern enhancements</p>
      </div>
      <div class="feature-card">
        <h3>Power-ups</h3>
        <p>Collect special weapons and abilities</p>
      </div>
    </div>
    
    <div class="instructions">
      <h3>HOW TO PLAY</h3>
      <ul>
        <li>Move with <strong>WASD</strong> or <strong>Arrow Keys</strong></li>
        <li>Shoot with <strong>SPACEBAR</strong> or <strong>LEFT MOUSE</strong></li>
        <li>Collect power-ups for enhanced weapons</li>
        <li>Defeat bosses to advance to the next level</li>
        <li>Survive as long as possible for high scores!</li>
      </ul>
    </div>
  </div>

  <footer>
    <p>Â© 2023 Jamie Bothwell Blast | Built with PyGame and Pygbag</p>
  </footer>

  <!-- Pygbag runtime -->
  <script src="https://pygame-web.github.io/archives/0.9/pythons.js" type="module" id="site" data-LINES="57" data-CONSOLE="25" data-python="python3.12" data-os="vtx,fs,snd,gui" async defer>
    <!--
    print("Booting JamieBothwellBlast...")
    
    WIDTH=1024
    HEIGHT=600
    REFX = 1980
    REFY = 1080
    
    def u(real, ref, v):
        if abs(v)<0.9999999:
            result = int((float(real)/100.0) * (v*1000))
            if v<0:
                return real-result
            return result
        return int((real/ref) * v)
    
    def ux(*argv):
        return sum([u(WIDTH, REFX, v) for v in argv])
    
    def uy(*argv):
        return sum([u(HEIGHT, REFY, v) for v in argv])
    
    async def custom_site():
        import platform
        import pygame
        import asyncio
        import json
        from pathlib import Path
    
        pygame.init()
        pygame.font.init()
        screen = pygame.display.set_mode([ux(.8), uy(.6)], pygame.SRCALPHA, 32)
        screen.set_colorkey((0,0,0,0), pygame.RLEACCEL)
        screen.fill((0,0,0,0))
        pygame.display.flip()
    
        apk = "jamiebothwellblast.apk"
        bundle = "jamiebothwellblast"
        appdir = Path(f"/data/data/{bundle}")
        appdir.mkdir()
    
        cfg = {
            "io": "url",
            "type": "mount",
            "mount": {"point": appdir.as_posix(), "path": "/"},
            "path": f"/ => {appdir.as_posix()}"
        }
    
        track = platform.window.MM.prepare(apk, json.dumps(cfg))
        while not track.ready:
            pygame.display.flip()
            await asyncio.sleep(.1)
    
        # Expose main path to JavaScript via Module object
        main = appdir / "assets" / "main.py"
        platform.window.Module.main_path = str(main)
        # Signal that main_path is ready
        platform.window.js.dispatchEvent(new Event('mainPathReady'))
    
    import asyncio
    asyncio.run(custom_site())
    # -->
  </script>

  <script>
    // Get DOM elements
    const canvas = document.getElementById("canvas");
    const container = document.getElementById("canvas-container");
    const playButton = document.getElementById("play-button");
    const fullscreenButton = document.getElementById("fullscreen-button");
    const gameOverlay = document.getElementById("game-overlay");
    const progressBar = document.getElementById("progress");
    const statusText = document.getElementById("status-text");
    
    // Initialize Module if it doesn't exist
    if (typeof Module === 'undefined') {
      window.Module = {};
    }
    
    // Handle high DPI displays
    function setupCanvas() {
      const dpr = window.devicePixelRatio || 1;
      
      // Set CSS dimensions (logical pixels)
      canvas.style.width = '1024px';
      canvas.style.height = '600px';
      
      // Set backing buffer size (physical pixels)
      canvas.width = 1024 * dpr;
      canvas.height = 600 * dpr;
      
      // Scale the context
      const ctx = canvas.getContext('2d');
      ctx.scale(dpr, dpr);
    }
    
    // Initial canvas setup
    setupCanvas();
    
    // Handle window resize
    window.addEventListener('resize', setupCanvas);
    
    // Update progress bar and status during loading
    Module.setStatus = function(text) {
      statusText.textContent = text;
    };
    
    Module.setProgress = function(value) {
      progressBar.value = value;
    };
    
    // Handle runtime initialization
    Module.onRuntimeInitialized = function() {
      statusText.textContent = "Game environment ready!";
      playButton.textContent = "START GAME";
      playButton.disabled = false;
    };
    
    // Listen for the mainPathReady event from Python
    document.addEventListener('mainPathReady', function() {
      // Enable the play button if runtime is already initialized
      if (Module.calledRun) {
        playButton.disabled = false;
      }
    });
    
    // Play button functionality
    playButton.addEventListener("click", function() {
      if (typeof Module !== 'undefined' && Module.PyRun_SimpleString && Module.main_path) {
        try {
          // Hide overlay and start game
          gameOverlay.style.opacity = '0';
          setTimeout(() => {
            gameOverlay.style.display = 'none';
          }, 500);
          
          // Execute game start commands
          Module.PyRun_SimpleString("platform.window.MM.UME = True");
          Module.PyRun_SimpleString(`shell.runpy("${Module.main_path}")`);
        } catch (e) {
          console.error("Error starting game:", e);
          statusText.textContent = "Error starting game. See console for details.";
          gameOverlay.style.display = 'flex';
          gameOverlay.style.opacity = '1';
        }
      } else {
        console.warn("Module not ready or main_path not set.");
        statusText.textContent = "Game not ready yet. Please wait...";
      }
    });
    
    // Fullscreen button functionality
    fullscreenButton.addEventListener("click", function() {
      if (!document.fullscreenElement) {
        container.requestFullscreen().catch(err => {
          console.error(`Fullscreen error: ${err.message}`);
        });
        fullscreenButton.textContent = "EXIT FULLSCREEN";
      } else {
        document.exitFullscreen();
        fullscreenButton.textContent = "FULLSCREEN";
      }
    });
    
    // Handle fullscreen change
    document.addEventListener("fullscreenchange", function() {
      if (document.fullscreenElement) {
        fullscreenButton.textContent = "EXIT FULLSCREEN";
      } else {
        fullscreenButton.textContent = "FULLSCREEN";
      }
    });
  </script>
</body>
</html>